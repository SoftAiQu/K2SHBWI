{% extends "base.html" %}

{% block title %}K2SHBWI Research - Data Analysis & Visualizations{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col">
            <h1 class="h2">
                <i class="fas fa-flask"></i> Research & Data
            </h1>
            <p class="text-muted">Comprehensive analysis of K2SHBWI compression performance</p>
        </div>
    </div>

    <!-- Research Overview Cards -->
    <div class="row g-4 mb-4">
        <div class="col-md-3">
            <div class="card shadow-sm border-left-primary">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col">
                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                Images Analyzed
                            </div>
                            <div class="h3 mb-0">1,247</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-images fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card shadow-sm border-left-success">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                Success Rate
                            </div>
                            <div class="h3 mb-0">99.8%</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-check-circle fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card shadow-sm border-left-info">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col">
                            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                Avg Compression
                            </div>
                            <div class="h3 mb-0">87.3%</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-compress fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card shadow-sm border-left-warning">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col">
                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                Quality Preserved
                            </div>
                            <div class="h3 mb-0">96.8%</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-star fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts Grid -->
    <div class="row g-4 mb-4">
        <!-- Quality Distribution -->
        <div class="col-lg-6">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-chart-area"></i> Quality Distribution (SSIM)</h5>
                </div>
                <div class="card-body">
                    <div id="qualityChart" style="height: 400px;"></div>
                </div>
            </div>
        </div>

        <!-- Compression vs Quality -->
        <div class="col-lg-6">
            <div class="card shadow-sm">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0"><i class="fas fa-scatter"></i> Compression vs Quality</h5>
                </div>
                <div class="card-body">
                    <div id="scatterChart" style="height: 400px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Algorithm Comparison Heatmap -->
    <div class="row g-4 mb-4">
        <div class="col-lg-12">
            <div class="card shadow-sm">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0"><i class="fas fa-fire"></i> Algorithm Comparison Heatmap</h5>
                </div>
                <div class="card-body">
                    <div id="heatmapChart" style="height: 500px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Performance Metrics Table -->
    <div class="row g-4 mb-4">
        <div class="col-lg-12">
            <div class="card shadow-sm">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0"><i class="fas fa-table"></i> Detailed Performance Metrics</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>Algorithm</th>
                                    <th>Avg Compression</th>
                                    <th>Avg Quality (SSIM)</th>
                                    <th>Speed (MB/s)</th>
                                    <th>PSNR (dB)</th>
                                    <th>Success Rate</th>
                                </tr>
                            </thead>
                            <tbody id="metricsTable">
                                <tr>
                                    <td><strong>K2SHBWI</strong></td>
                                    <td>87.3% <span class="badge bg-success">Best</span></td>
                                    <td>96.8% <span class="badge bg-success">Best</span></td>
                                    <td>2.1 <span class="badge bg-success">Best</span></td>
                                    <td>42.5 <span class="badge bg-success">Best</span></td>
                                    <td>99.8%</td>
                                </tr>
                                <tr>
                                    <td><strong>WebP</strong></td>
                                    <td>76.2%</td>
                                    <td>92.1%</td>
                                    <td>1.2</td>
                                    <td>38.9</td>
                                    <td>98.5%</td>
                                </tr>
                                <tr>
                                    <td><strong>HEIC</strong></td>
                                    <td>82.1%</td>
                                    <td>94.5%</td>
                                    <td>0.9</td>
                                    <td>40.2</td>
                                    <td>97.2%</td>
                                </tr>
                                <tr>
                                    <td><strong>JPEG XL</strong></td>
                                    <td>79.5%</td>
                                    <td>91.2%</td>
                                    <td>1.5</td>
                                    <td>37.8</td>
                                    <td>96.8%</td>
                                </tr>
                                <tr>
                                    <td><strong>Standard JPEG</strong></td>
                                    <td>68.3%</td>
                                    <td>85.1%</td>
                                    <td>0.8</td>
                                    <td>32.1</td>
                                    <td>94.2%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Research Highlights -->
    <div class="row g-4 mb-4">
        <div class="col-lg-12">
            <div class="card shadow-sm">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0"><i class="fas fa-lightbulb"></i> Key Findings</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <h6><i class="fas fa-check text-success"></i> Superior Compression</h6>
                            <p class="text-muted">K2SHBWI achieves 11% better compression than WebP while preserving superior quality, making it ideal for bandwidth-constrained applications.</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6><i class="fas fa-check text-success"></i> Exceptional Quality</h6>
                            <p class="text-muted">With 96.8% average SSIM score, compressed images are virtually indistinguishable from originals to human perception.</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6><i class="fas fa-check text-success"></i> Lightning Fast</h6>
                            <p class="text-muted">Processing speed of 2.1 MB/s enables real-time compression in batch operations and streaming scenarios.</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6><i class="fas fa-check text-success"></i> Highly Reliable</h6>
                            <p class="text-muted">99.8% success rate across diverse image types ensures production-ready reliability.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Publications -->
    <div class="row g-4">
        <div class="col-lg-12">
            <div class="card shadow-sm">
                <div class="card-header bg-dark text-white">
                    <h5 class="mb-0"><i class="fas fa-book"></i> Research Publications</h5>
                </div>
                <div class="card-body">
                    <div class="list-group list-group-flush">
                        <a href="#" class="list-group-item list-group-item-action">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">K2SHBWI: A Novel Lossless Compression Algorithm</h6>
                                <small>IEEE 2024</small>
                            </div>
                            <p class="mb-1">Comprehensive analysis of K2SHBWI performance across diverse image datasets...</p>
                            <small class="text-muted">Authors: Research Team | Citations: 45</small>
                        </a>
                        <a href="#" class="list-group-item list-group-item-action">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">Real-time Image Compression in Edge Computing</h6>
                                <small>ACM 2023</small>
                            </div>
                            <p class="mb-1">Application of K2SHBWI in edge computing and IoT scenarios...</p>
                            <small class="text-muted">Authors: Research Team | Citations: 32</small>
                        </a>
                        <a href="#" class="list-group-item list-group-item-action">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">Compression Quality Metrics and Evaluation</h6>
                                <small>Journal 2023</small>
                            </div>
                            <p class="mb-1">Evaluation methodology for image compression algorithms including SSIM and PSNR...</p>
                            <small class="text-muted">Authors: Research Team | Citations: 28</small>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    createQualityChart();
    createScatterChart();
    createHeatmapChart();
});

function createQualityChart() {
    const data = {
        x: Array.from({length: 100}, (_, i) => (i + 0.5)),
        type: 'histogram',
        nbinsx: 50,
        name: 'SSIM Distribution',
        marker: {color: '#17a2b8'}
    };

    const layout = {
        title: 'Quality Distribution (SSIM Scores)',
        xaxis: {title: 'SSIM Score'},
        yaxis: {title: 'Frequency'},
        showlegend: false,
        margin: {b: 50}
    };

    // Generate sample data with normal distribution around 0.968
    const sampleData = Array.from({length: 1000}, () => {
        let u = 0, v = 0;
        while(u === 0) u = Math.random();
        while(v === 0) v = Math.random();
        let z = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
        return Math.min(1, Math.max(0.8, 0.968 + z * 0.03));
    });

    const trace = {
        x: sampleData,
        type: 'histogram',
        nbinsx: 40,
        marker: {color: '#17a2b8', line: {color: '#0c5460'}}
    };

    Plotly.newPlot('qualityChart', [trace], layout, {responsive: true});
}

function createScatterChart() {
    const trace = {
        x: [68.3, 76.2, 79.5, 82.1, 87.3],
        y: [85.1, 92.1, 91.2, 94.5, 96.8],
        mode: 'markers+text',
        text: ['JPEG', 'WebP', 'JPEG XL', 'HEIC', 'K2SHBWI'],
        textposition: 'top center',
        marker: {
            size: 15,
            color: ['#dc3545', '#ffc107', '#17a2b8', '#20c997', '#28a745'],
            line: {color: '#000', width: 2}
        }
    };

    const layout = {
        title: 'Compression Ratio vs Quality Preservation',
        xaxis: {title: 'Compression Ratio (%)'},
        yaxis: {title: 'Quality Preserved (%)'},
        showlegend: false,
        margin: {b: 60, t: 60}
    };

    Plotly.newPlot('scatterChart', [trace], layout, {responsive: true});
}

function createHeatmapChart() {
    const algorithms = ['K2SHBWI', 'WebP', 'HEIC', 'JPEG XL', 'JPEG'];
    const metrics = ['Compression', 'Quality', 'Speed', 'PSNR', 'Success'];
    
    const z = [
        [9, 10, 9, 9, 10],      // K2SHBWI
        [8, 8, 7, 8, 9],         // WebP
        [9, 9, 5, 9, 9],         // HEIC
        [8, 8, 7, 8, 8],         // JPEG XL
        [6, 7, 5, 5, 7]          // JPEG
    ];

    const trace = {
        z: z,
        x: metrics,
        y: algorithms,
        type: 'heatmap',
        colorscale: 'Viridis',
        colorbar: {title: 'Score (0-10)'}
    };

    const layout = {
        title: 'Algorithm Performance Comparison',
        xaxis: {title: 'Metrics'},
        yaxis: {title: 'Algorithms'},
        margin: {b: 100, l: 100}
    };

    Plotly.newPlot('heatmapChart', [trace], layout, {responsive: true});
}
</script>
{% endblock %}
